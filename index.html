<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WXCODE - å¾®ä¿¡å·åŠ å¯†</title>
<style>
  :root {
    --bg: #f5f5f7;
    --white: #ffffff;
    --text: #1d1d1f;
    --text2: #6e6e73;
    --text3: #aeaeb2;
    --border: #e5e5ea;
    --blue: #007AFF;
    --blue-bg: rgba(0,122,255,0.08);
    --green: #34C759;
    --green-bg: rgba(52,199,89,0.08);
    --purple: #AF52DE;
    --purple-bg: rgba(175,82,222,0.08);
    --radius: 16px;
    --shadow: 0 1px 3px rgba(0,0,0,0.04), 0 4px 12px rgba(0,0,0,0.04);
    --shadow-hover: 0 2px 8px rgba(0,0,0,0.06), 0 8px 24px rgba(0,0,0,0.06);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text',
                 'Helvetica Neue', Helvetica, Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    padding: 0 20px 60px;
    -webkit-font-smoothing: antialiased;
  }

  /* ===== Header ===== */
  header {
    text-align: center;
    padding: 56px 0 40px;
    max-width: 560px;
    margin: 0 auto;
  }
  header h1 {
    font-size: 34px;
    font-weight: 700;
    letter-spacing: -0.5px;
    line-height: 1.15;
    margin-bottom: 10px;
  }
  header p {
    font-size: 17px;
    color: var(--text2);
    font-weight: 400;
    line-height: 1.5;
  }
  .author-link {
    font-size: 14px;
    margin-top: 12px;
  }
  .author-link a {
    color: var(--blue);
    text-decoration: none;
  }
  .author-link a:hover {
    text-decoration: underline;
  }

  /* ===== Container ===== */
  .container {
    max-width: 560px;
    margin: 0 auto;
  }

  /* ===== Input Section ===== */
  .input-card {
    background: var(--white);
    border-radius: var(--radius);
    padding: 24px;
    box-shadow: var(--shadow);
    margin-bottom: 32px;
  }
  .input-row {
    display: flex;
    gap: 12px;
  }
  .input-field {
    flex: 1;
    height: 50px;
    border: 1.5px solid var(--border);
    border-radius: 12px;
    padding: 0 16px;
    font-size: 17px;
    font-family: inherit;
    color: var(--text);
    background: var(--bg);
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
  }
  .input-field:focus {
    border-color: var(--blue);
    box-shadow: 0 0 0 3px rgba(0,122,255,0.12);
  }
  .input-field::placeholder { color: var(--text3); }
  .btn-main {
    height: 50px;
    padding: 0 28px;
    background: var(--blue);
    color: #fff;
    border: none;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 600;
    font-family: inherit;
    cursor: pointer;
    white-space: nowrap;
    transition: background 0.2s, transform 0.1s;
  }
  .btn-main:hover { background: #0066d6; }
  .btn-main:active { transform: scale(0.97); }

  /* ===== Verification Card ===== */
  .verify-card {
    background: var(--white);
    border-radius: var(--radius);
    padding: 20px 24px;
    box-shadow: var(--shadow);
    margin-bottom: 32px;
  }
  .verify-card.verified {
    background: var(--green-bg);
    border: 1.5px solid var(--green);
  }
  .verify-row {
    display: flex;
    gap: 12px;
  }
  .btn-verify {
    height: 50px;
    padding: 0 24px;
    background: var(--green);
    color: #fff;
    border: none;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 600;
    font-family: inherit;
    cursor: pointer;
    white-space: nowrap;
    transition: background 0.2s, transform 0.1s;
  }
  .btn-verify:hover { background: #2db84d; }
  .btn-verify:active { transform: scale(0.97); }
  .verify-hint {
    font-size: 13px;
    margin-top: 10px;
    padding-left: 2px;
  }
  .verify-hint.error { color: #ff3b30; }
  .verify-hint.success { color: var(--green); }

  /* Disabled state for buttons */
  .btn-copy.disabled, .btn-save.disabled {
    opacity: 0.4;
    cursor: not-allowed;
    pointer-events: none;
  }

  /* ===== Results ===== */
  .results { display: none; }
  .results.show { display: block; }

  /* ===== Card ===== */
  .card {
    background: var(--white);
    border-radius: var(--radius);
    padding: 22px 24px;
    box-shadow: var(--shadow);
    margin-bottom: 14px;
    transition: box-shadow 0.3s;
  }
  .card:hover { box-shadow: var(--shadow-hover); }
  .card-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 14px;
  }
  .card-info { display: flex; align-items: center; gap: 10px; }
  .card-icon {
    width: 34px; height: 34px;
    border-radius: 8px;
    display: flex; align-items: center; justify-content: center;
    font-size: 16px;
    flex-shrink: 0;
  }
  .card-icon.blue   { background: var(--blue-bg); }
  .card-icon.green  { background: var(--green-bg); }
  .card-icon.purple { background: var(--purple-bg); }
  .card-label .title {
    font-size: 15px;
    font-weight: 600;
    color: var(--text);
  }
  .card-label .desc {
    font-size: 12px;
    color: var(--text3);
    margin-top: 1px;
  }

  /* Copy button - prominent Apple style */
  .btn-copy {
    display: flex; align-items: center; gap: 6px;
    height: 36px;
    padding: 0 16px;
    background: var(--bg);
    border: 1.5px solid var(--border);
    border-radius: 10px;
    font-size: 14px;
    font-weight: 500;
    font-family: inherit;
    color: var(--blue);
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
    flex-shrink: 0;
  }
  .btn-copy:hover {
    background: var(--blue-bg);
    border-color: var(--blue);
  }
  .btn-copy:active { transform: scale(0.96); }
  .btn-copy.copied {
    background: var(--green-bg);
    border-color: var(--green);
    color: var(--green);
  }
  .btn-copy svg { width: 15px; height: 15px; }

  .output-box {
    background: var(--bg);
    border-radius: 10px;
    padding: 14px 16px;
    font-size: 16px;
    line-height: 1.7;
    color: var(--text);
    word-break: break-all;
    min-height: 48px;
    user-select: all;
  }
  .card-hint {
    font-size: 12px;
    color: var(--text3);
    margin-top: 10px;
    padding-left: 2px;
  }

  /* ===== AI Card ===== */
  .card.ai-card { position: relative; overflow: hidden; }
  .ai-badge {
    display: inline-flex; align-items: center; gap: 4px;
    font-size: 11px; font-weight: 600;
    color: var(--purple);
    background: var(--purple-bg);
    padding: 3px 8px;
    border-radius: 6px;
    margin-left: 8px;
    vertical-align: middle;
  }
  .ai-loading {
    display: none;
    align-items: center;
    gap: 8px;
    padding: 14px 16px;
    background: var(--bg);
    border-radius: 10px;
    font-size: 14px;
    color: var(--text2);
  }
  .ai-loading.show { display: flex; }
  .ai-dot {
    display: flex; gap: 4px;
  }
  .ai-dot span {
    width: 6px; height: 6px;
    border-radius: 50%;
    background: var(--purple);
    animation: dotPulse 1.2s ease infinite;
  }
  .ai-dot span:nth-child(2) { animation-delay: 0.2s; }
  .ai-dot span:nth-child(3) { animation-delay: 0.4s; }
  @keyframes dotPulse {
    0%, 80%, 100% { opacity: 0.25; transform: scale(0.8); }
    40% { opacity: 1; transform: scale(1); }
  }

  /* ===== Image Section ===== */
  .img-section {
    background: var(--white);
    border-radius: var(--radius);
    padding: 22px 24px;
    box-shadow: var(--shadow);
    margin-bottom: 14px;
  }
  .img-row {
    display: flex;
    gap: 12px;
    margin-top: 14px;
  }
  .canvas-wrap {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg);
    border-radius: 12px;
    padding: 10px;
    min-height: 130px;
  }
  .canvas-wrap canvas {
    border-radius: 8px;
    max-width: 100%;
  }
  .img-actions {
    display: flex;
    gap: 10px;
    margin-top: 14px;
  }
  .btn-refresh, .btn-save {
    flex: 1;
    height: 42px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    font-family: inherit;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
  }
  .btn-refresh {
    background: var(--bg);
    border: 1.5px solid var(--border);
    color: var(--text2);
  }
  .btn-refresh:hover { border-color: var(--blue); color: var(--blue); }
  .btn-save {
    background: var(--blue);
    border: none;
    color: #fff;
  }
  .btn-save:hover { background: #0066d6; }
  .btn-save:active, .btn-refresh:active { transform: scale(0.97); }

  /* ===== Tips ===== */
  .tips {
    background: var(--white);
    border-radius: var(--radius);
    padding: 20px 24px;
    box-shadow: var(--shadow);
    margin-top: 20px;
  }
  .tips-title {
    font-size: 13px;
    font-weight: 600;
    color: var(--text2);
    margin-bottom: 10px;
  }
  .tips li {
    font-size: 13px;
    color: var(--text2);
    line-height: 2;
    list-style: none;
    padding-left: 18px;
    position: relative;
  }
  .tips li::before {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    width: 6px; height: 6px;
    border-radius: 50%;
    background: var(--border);
    transform: translateY(-50%);
  }
  .tips li strong {
    font-weight: 600;
    color: var(--text);
  }

  /* ===== Animation ===== */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  .results.show > * {
    animation: fadeIn 0.35s ease both;
  }
  .results.show > :nth-child(1) { animation-delay: 0s; }
  .results.show > :nth-child(2) { animation-delay: 0.04s; }
  .results.show > :nth-child(3) { animation-delay: 0.08s; }
  .results.show > :nth-child(4) { animation-delay: 0.12s; }
  .results.show > :nth-child(5) { animation-delay: 0.16s; }
  .results.show > :nth-child(6) { animation-delay: 0.20s; }
  .results.show > :nth-child(7) { animation-delay: 0.24s; }
  .results.show > :nth-child(8) { animation-delay: 0.28s; }

  /* ===== Footer ===== */
  footer {
    text-align: center;
    margin-top: 40px;
    font-size: 12px;
    color: var(--text3);
  }

  /* ===== Responsive ===== */
  @media (max-width: 480px) {
    header h1 { font-size: 28px; }
    .input-row { flex-direction: column; }
    .btn-main { width: 100%; }
    .card { padding: 18px 18px; }
  }
</style>
</head>
<body>

<header>
  <h1>å¾®ä¿¡å·åŠ å¯†ä¼ è¾“</h1>
  <p>è®©æœºå™¨çœ‹ä¸æ‡‚ï¼Œè®©äººçœ‹å¾—æ‡‚</p>
  <p class="author-link">@å°çº¢ä¹¦ï¼šAI äº§å“å°è¡Œå®¶ <a href="https://xhslink.com/m/4SHro9DoE2a" target="_blank">æˆ‘å·²å…¥é©»REDCityï¼Œæ¥çœ‹çœ‹æˆ‘çš„ä¸»é¡µ>></a></p>
</header>

<div class="container">
  <!-- Input -->
  <div class="input-card">
    <div class="input-row">
      <input class="input-field" type="text" id="wxInput" placeholder="è¾“å…¥ä½ çš„å¾®ä¿¡å·" maxlength="40" autocomplete="off" spellcheck="false">
      <button class="btn-main" onclick="generate()">ç”Ÿæˆ</button>
    </div>
  </div>

  <!-- Verification Code -->
  <div class="verify-card" id="verifyCard">
    <div class="verify-row">
      <input class="input-field" type="text" id="codeInput" placeholder="è¾“å…¥éªŒè¯ç è§£é”å¤åˆ¶/ä¸‹è½½" maxlength="10" autocomplete="off" spellcheck="false" style="text-transform:uppercase;">
      <button class="btn-verify" onclick="verifyCode()">éªŒè¯</button>
    </div>
    <div class="verify-hint" id="verifyHint"></div>
  </div>

  <!-- Results -->
  <div class="results" id="results">

    <!-- AI Creative -->
    <div class="card ai-card">
      <div class="card-top">
        <div class="card-info">
          <div class="card-icon purple">ğŸ¤–</div>
          <div class="card-label">
            <div class="title">AI åˆ›æ„ç¼–ç  <span class="ai-badge">âœ¦ AI</span></div>
            <div class="desc">DeepSeek ç”Ÿæˆåˆ›æ„éšå†™æ–‡æ¡ˆ</div>
          </div>
        </div>
        <button class="btn-copy" onclick="copyText(this,'outAI')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
          å¤åˆ¶
        </button>
      </div>
      <div class="ai-loading" id="aiLoading">
        <div class="ai-dot"><span></span><span></span><span></span></div>
        AI æ­£åœ¨åˆ›ä½œä¸­...
      </div>
      <div class="output-box" id="outAI" style="display:none;"></div>
      <div class="card-hint" id="aiHint"></div>
    </div>

    <!-- Homoglyph -->
    <div class="card">
      <div class="card-top">
        <div class="card-info">
          <div class="card-icon blue">ğŸ”¤</div>
          <div class="card-label">
            <div class="title">åŒå½¢å­—æ›¿æ¢</div>
            <div class="desc">Unicode åŒå½¢å­—ç¬¦ï¼Œè‚‰çœ¼æ— æ³•åŒºåˆ†</div>
          </div>
        </div>
        <button class="btn-copy" onclick="copyText(this,'out1')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
          å¤åˆ¶
        </button>
      </div>
      <div class="output-box" id="out1"></div>
      <div class="card-hint">æç¤ºå¯¹æ–¹ï¼šç…§ç€æ‰‹åŠ¨æ‰“ä¸€éå°±æ˜¯æˆ‘çš„ V</div>
    </div>

    <!-- Emoji -->
    <div class="card">
      <div class="card-top">
        <div class="card-info">
          <div class="card-icon green">âœ¦</div>
          <div class="card-label">
            <div class="title">ç¬¦å·é—´éš”</div>
            <div class="desc">éšæœºç¬¦å·å¡«å……ï¼Œå»æ‰å³ä¸ºåŸæ–‡</div>
          </div>
        </div>
        <button class="btn-copy" onclick="copyText(this,'out2')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
          å¤åˆ¶
        </button>
      </div>
      <div class="output-box" id="out2"></div>
      <div class="card-hint">æç¤ºå¯¹æ–¹ï¼šå»æ‰ç¬¦å·å°±æ˜¯æˆ‘çš„ V</div>
    </div>

    <!-- Phonetic -->
    <div class="card">
      <div class="card-top">
        <div class="card-info">
          <div class="card-icon blue">ğŸ€„</div>
          <div class="card-label">
            <div class="title">è°éŸ³å¯†ç </div>
            <div class="desc">æ•°å­—è½¬è°éŸ³æ±‰å­—ï¼Œè¯»å‡ºæ¥å³è¿˜åŸ</div>
          </div>
        </div>
        <button class="btn-copy" onclick="copyText(this,'out3')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
          å¤åˆ¶
        </button>
      </div>
      <div class="output-box" id="out3"></div>
      <div class="card-hint">æç¤ºå¯¹æ–¹ï¼šä¸­æ–‡è¯»å‡ºæ¥æ›¿æ¢æˆæ•°å­—</div>
    </div>

    <!-- Zero-width -->
    <div class="card">
      <div class="card-top">
        <div class="card-info">
          <div class="card-icon green">ğŸ‘»</div>
          <div class="card-label">
            <div class="title">é›¶å®½æ³¨å…¥</div>
            <div class="desc">æ’å…¥ä¸å¯è§å­—ç¬¦ï¼Œå¤–è§‚ä¸åŸæ–‡å®Œå…¨ä¸€è‡´</div>
          </div>
        </div>
        <button class="btn-copy" onclick="copyText(this,'out4')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
          å¤åˆ¶
        </button>
      </div>
      <div class="output-box" id="out4"></div>
      <div class="card-hint">å¤–è§‚å®Œå…¨ä¸€è‡´ï¼Œéšè—å­—ç¬¦ç ´åå…³é”®è¯åŒ¹é…</div>
    </div>

    <!-- Image CAPTCHA -->
    <div class="img-section">
      <div class="card-top">
        <div class="card-info">
          <div class="card-icon purple">ğŸ–¼</div>
          <div class="card-label">
            <div class="title">éªŒè¯ç å›¾ç‰‡</div>
            <div class="desc">æ¯æ¬¡ç”Ÿæˆéšæœºæ ·å¼ï¼Œå®Œå…¨è§„é¿æ–‡å­—æ£€æµ‹</div>
          </div>
        </div>
      </div>
      <div class="canvas-wrap">
        <canvas id="imgCanvas"></canvas>
      </div>
      <div class="img-actions">
        <button class="btn-refresh" onclick="refreshImage()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M21.5 2v6h-6"/><path d="M21.34 15.57a10 10 0 11-.57-8.38L21.5 8"/></svg>
          æ¢ä¸€ä¸ªæ ·å¼
        </button>
        <button class="btn-save" onclick="saveImage()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
          ä¿å­˜å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- Tips -->
    <div class="tips">
      <div class="tips-title">ä½¿ç”¨å»ºè®®</div>
      <ul>
        <li><strong>åŒå½¢å­— / é›¶å®½æ³¨å…¥</strong> æœ€éšè”½ï¼Œå¤–è§‚ä¸åŸæ–‡ä¸€è‡´</li>
        <li><strong>éªŒè¯ç å›¾ç‰‡</strong> æœ€å®‰å…¨ï¼Œå›¾ç‰‡ä¸è§¦å‘æ–‡å­—æ£€æµ‹</li>
        <li>æé†’å¯¹æ–¹ <strong>æ‰‹åŠ¨è¾“å…¥</strong> è€Œéå¤åˆ¶ç²˜è´´</li>
        <li>å¯ç”¨ <strong>V / VX / å¨</strong> ä»£æ›¿ã€Œå¾®ä¿¡ã€äºŒå­—</li>
      </ul>
    </div>

  </div>
</div>

<footer>WXCODE &copy; 2025</footer>

<script>
// ======================== CONFIG ========================
const DS_API = 'https://wxcode-site.vercel.app/api/ai';

// ======================== VERIFICATION CODES ========================
const VALID_CODES = new Set([
  'FHBKHCPC','5J6JSPL7','ENFWDUGN','8AQCVJAL','HQMY7PEQ','GB7BJZNN','Z2SHE6VA','Q2EKXA4K',
  'F9DQXKPC','4AFQEQ82','P3ZAA5RY','CW3D9MGA','2W6QBSR6','UNWC6CPG','62QGAAH5','YEN95Q5S',
  'SYVMNAGQ','WAN5P7CM','YCLBJPD5','6DTV5EJ5','ZZKUXCLF','5AZ9TFMS','BV2C8DC7','FCGCMJSW',
  '96QS9GC7','3Y4KCYAW','88WH2YF9','9TZC3D6L','GGJX9GRG','R727ALEA','JWG3P3EX','JUKYA678',
  '3GQGESFM','GEEHJDEQ','EGZXUQEZ','WT88ADFW','9RGFMYME','GVWXGD4Y','2XC8GT68','TPZ6PPAT',
  'SB5ZE2AQ','6NF4WKM4','3STEY2AZ','KM9Z52UP','7NKCK2NE','NALMCT7H','RSZ4734X','APX4K5FV',
  'ZUWT87HS','WTRTCSX3','TQHGVA7A','F2L2HG4G','S4HGHG8Y','NKT5QYCY','5STVZYZC','9W4WUS9B',
  'GLKBCJKL','A42TTAHQ','RYWMX3GK','5ERJM3H8','LZQNT42J','33KKTHB9','ZVSQRRQD','Y8UHN2NL',
  '9W88GE2X','JFJ8TGAN','D8MURW38','MUT3MSDM','5ATXMJVE','FXB7VDWV','CFLKGLGG','SUTT4HGZ',
  'SJN7V6ZY','6UKWFPU7','5Z5ZSSA6','T8BJZ58U','4Z54XBCC','TJX22Z5N','WYCS95Z9','ZNPECDQM',
  'UBFAVL2Y','L8REMYXD','8VZVWFRV','65PZ3PWH','JAVAHC5X','T6AZ6H8B','SBFB3NBK','BL2C97R4',
  '3BD3EF6M','D8ET75CQ','BA7SV4GG','ZPDT7LJ3','XX32LGT7','Q7J5T6EF','ELYADSN2','JF8MRKWY',
  '2E9CVQFC','X98RAKFQ','T5WKTZ8R','P7MMKUFG','SSHLEJFN','ZENAU75S','JTTZVHTX','3ZH59AVZ',
  '4NFRU3CX','5NPHXKSN','Q62U9YES','P9ZTH96N','8UFXX448','Z9QYC7B7','P2PB764X','JNYQLURE',
  'X9CCA3SC','ACEBEHP5','MPKP6S4E','4CSAFEJS','TST9GU6F','WT6FSVQM','C8ZDVWAH','RYD75NK6',
  'VQDWRK3J','3MKA6MGE','MHHCUP4U','J3HEMBVF','NZRK499Z','5VS93VCD','NT262CVA','FC5RZRWV',
  'SF5M5G4K','AD4Z8F57','MG6QH8PS','FJUEQ3CM','ZGSS7ZGU','7A3HMAX5','V893UB9N','2X8CWJFH',
  'ZGK6J9D4','A7MWEXM7','5FXJB22Q','CSRQHC62','SJM4HTVP','HLAP7MGS','JZR6L3LU','SYGX7HZJ',
  '3TPJH3BY','LYEL7CFK','E4Z464P4','GN4BKM6A','F6N8NQJB','6YDU9BFU','T4RV26J8','T7FGCEBV',
  'SCCY4WT6','6PFQWGVL','CURSHBSP','MSSW2KPX','L2B8234R','XAJZDLPE','4G4CRQWW','F52B8XXA',
  'WCPJRRQP','P6K6ZDV6','SP48EYT8','PLGBAHWC','JS4Y6DWV','XM66RQBJ','5NA7EB7K','LYZPH5C7',
  'ABYT9RC3','W96QJCB7','CG8SMPCC','TNRM3YNE','TDQ7Y425','8PHJ4Q6K','29NMA5YQ','7Q59652C',
  '3CN5VPFM','LJZFSDS6','BD3BEDY4','4V6VWK58','WBRLMVAR','K2DWUST5','4GA2WTUR','NU5Y8LZK',
  '4ECPC5F6','7G6FGH44','SRT7F4DE','9FH83SV2','R83VT7B8','8A3C647G','SAAVEYK7','4L2J4TLZ',
  'LGY9F5DD','TPV9W4S5','Z695HZ79','8TPFWMJV','SJBQD6SS','CCM3S7WU','BCMQ5LXH','75HB69W5'
]);

let isVerified = localStorage.getItem('wxcode_verified') === 'true';

function verifyCode() {
  const input = document.getElementById('codeInput');
  const hint = document.getElementById('verifyHint');
  const card = document.getElementById('verifyCard');
  const code = input.value.trim().toUpperCase();

  if (VALID_CODES.has(code)) {
    isVerified = true;
    localStorage.setItem('wxcode_verified', 'true');
    card.classList.add('verified');
    hint.className = 'verify-hint success';
    hint.textContent = 'éªŒè¯æˆåŠŸï¼å·²è§£é”å…¨éƒ¨åŠŸèƒ½';
    input.disabled = true;
    updateButtonStates();
  } else {
    hint.className = 'verify-hint error';
    hint.textContent = 'éªŒè¯ç æ— æ•ˆï¼Œè¯·æ£€æŸ¥åé‡è¯•';
  }
}

function updateButtonStates() {
  const copyBtns = document.querySelectorAll('.btn-copy');
  const saveBtn = document.querySelector('.btn-save');
  copyBtns.forEach(btn => {
    if (isVerified) {
      btn.classList.remove('disabled');
    } else {
      btn.classList.add('disabled');
    }
  });
  if (saveBtn) {
    if (isVerified) {
      saveBtn.classList.remove('disabled');
    } else {
      saveBtn.classList.add('disabled');
    }
  }
}

// Check verification on page load
window.addEventListener('DOMContentLoaded', () => {
  if (isVerified) {
    const card = document.getElementById('verifyCard');
    const hint = document.getElementById('verifyHint');
    const input = document.getElementById('codeInput');
    card.classList.add('verified');
    hint.className = 'verify-hint success';
    hint.textContent = 'å·²éªŒè¯ï¼Œå…¨éƒ¨åŠŸèƒ½å·²è§£é”';
    input.disabled = true;
    input.placeholder = 'å·²éªŒè¯';
  }
  updateButtonStates();
});

// ======================== ENCODING MAPS ========================
const homoglyphs = {
  'a':'Ğ°','c':'Ñ','d':'Ô','e':'Ğµ','g':'É¡','h':'Ò»','i':'Ñ–','j':'Ñ˜',
  'l':'Ó','o':'Ğ¾','p':'Ñ€','s':'Ñ•','v':'Î½','x':'Ñ…','y':'Ñƒ',
  'A':'Ğ','B':'Ğ’','C':'Ğ¡','E':'Ğ•','H':'Ğ','I':'Ğ†','J':'Ğˆ',
  'K':'Ğš','M':'Ğœ','O':'Ğ','P':'Ğ ','S':'Ğ…','T':'Ğ¢','X':'Ğ¥','Y':'Ğ£',
  '0':'ÎŸ','1':'Æ–',
};
const symbols = ['Â·','âŠ¹','â‹®','â—¦','â–‘','â–ª','â•Œ','â—Œ','âŠ™','âŠ˜','âŠ¶','á€','âŠ¸','âŒ‡','âŠ·'];
const emojis = ['ğŸŒ¸','âœ¨','ğŸŒ™','ğŸ’«','â­','ğŸ¦‹','ğŸ’','ğŸ€','ğŸ’œ','ğŸƒ'];
const fillers = [...symbols, ...emojis];
const phoneticMap = {'0':'é›¶','1':'å¹º','2':'å°”','3':'ä»¨','4':'æ€','5':'å””','6':'æºœ','7':'æŸ’','8':'æŒ','9':'ç–'};
const zw = ['\u200B','\u200C','\u200D','\uFEFF'];
const R = a => a[Math.floor(Math.random()*a.length)];
const RI = (a,b) => Math.floor(Math.random()*(b-a))+a;

// ======================== ENCODERS ========================
const encodeHomoglyph = t => [...t].map(c => homoglyphs[c] && Math.random()<0.75 ? homoglyphs[c] : c).join('');
const encodeEmoji = t => [...t].map((c,i) => i<t.length-1 ? c+R(fillers) : c).join('');
const encodePhonetic = t => [...t].map(c => phoneticMap[c]||c).join('');
const encodeZeroWidth = t => [...t].map((c,i) => {
  if(i>=t.length-1) return c;
  let z=''; for(let k=0;k<RI(1,4);k++) z+=R(zw); return c+z;
}).join('');

// ======================== AI ENCODER ========================
let currentWxId = '';
async function aiEncode(wxid) {
  const el = document.getElementById('outAI');
  const loading = document.getElementById('aiLoading');
  const hint = document.getElementById('aiHint');
  el.style.display = 'none';
  loading.classList.add('show');
  hint.textContent = '';
  try {
    const res = await fetch(DS_API, {
      method: 'POST',
      headers: { 'Content-Type':'application/json' },
      body: JSON.stringify({ wxid })
    });
    const data = await res.json();
    const text = data.choices?.[0]?.message?.content || 'ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•';
    loading.classList.remove('show');
    el.style.display = 'block';
    el.textContent = text;
    hint.textContent = 'ç”± DeepSeek AI ç”Ÿæˆï¼Œæ¯æ¬¡ç»“æœä¸åŒ';
  } catch(e) {
    loading.classList.remove('show');
    el.style.display = 'block';
    el.textContent = 'AI è¯·æ±‚å¤±è´¥ï¼š' + (e.message || 'ç½‘ç»œé”™è¯¯');
    hint.textContent = 'è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•';
  }
}

// ======================== CAPTCHA IMAGE STYLES ========================
function setupCanvas(text) {
  const canvas = document.getElementById('imgCanvas');
  const ctx = canvas.getContext('2d');
  const dpr = window.devicePixelRatio || 1;
  const w = Math.max(340, text.length * 32 + 80);
  const h = 140;
  canvas.width = w * dpr;
  canvas.height = h * dpr;
  canvas.style.width = Math.min(w, 480) + 'px';
  canvas.style.height = h * (Math.min(w, 480) / w) + 'px';
  ctx.scale(dpr, dpr);
  return { canvas, ctx, w, h };
}

function hsl(h,s,l) { return `hsl(${h},${s}%,${l}%)`; }

// Style 1: Classic CAPTCHA - wavy colored text, scratchy lines
function drawStyle1(text) {
  const {ctx,w,h} = setupCanvas(text);
  // bg
  const baseHue = RI(0,360);
  ctx.fillStyle = hsl(baseHue, 15, 95);
  ctx.fillRect(0,0,w,h);
  // noise dots
  for(let i=0;i<80;i++) {
    ctx.fillStyle = hsl(RI(0,360), 30, RI(70,90));
    ctx.beginPath();
    ctx.arc(RI(0,w), RI(0,h), RI(1,3), 0, Math.PI*2);
    ctx.fill();
  }
  // interference lines
  for(let i=0;i<5;i++) {
    ctx.strokeStyle = hsl(RI(0,360), 40, RI(60,80));
    ctx.lineWidth = RI(1,3);
    ctx.beginPath();
    ctx.moveTo(RI(0,w*0.2), RI(0,h));
    ctx.bezierCurveTo(RI(0,w), RI(0,h), RI(0,w), RI(0,h), RI(w*0.8,w), RI(0,h));
    ctx.stroke();
  }
  // chars on sine wave
  const charW = 28;
  const startX = (w - text.length * charW) / 2 + charW / 2;
  const fonts = ['Georgia','Arial','Courier New','Verdana','Times New Roman'];
  [...text].forEach((ch, i) => {
    ctx.save();
    const x = startX + i * charW;
    const y = h/2 + Math.sin(i*0.8 + Math.random())*15;
    ctx.translate(x, y);
    ctx.rotate((Math.random()-0.5)*0.5);
    const size = RI(26,36);
    ctx.font = `${R(['bold','800','900'])} ${size}px "${R(fonts)}"`;
    ctx.fillStyle = hsl(RI(0,360), RI(60,90), RI(25,45));
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(ch, 0, 0);
    ctx.restore();
  });
  // top scratches
  for(let i=0;i<3;i++) {
    ctx.strokeStyle = hsl(baseHue, 20, RI(75,88));
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(RI(0,w), RI(0,h));
    ctx.lineTo(RI(0,w), RI(0,h));
    ctx.stroke();
  }
}

// Style 2: Neon on dark
function drawStyle2(text) {
  const {ctx,w,h} = setupCanvas(text);
  ctx.fillStyle = '#1a1a2e';
  ctx.fillRect(0,0,w,h);
  // grid
  ctx.strokeStyle = 'rgba(255,255,255,0.03)';
  ctx.lineWidth = 1;
  for(let x=0;x<w;x+=16) { ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,h); ctx.stroke(); }
  for(let y=0;y<h;y+=16) { ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(w,y); ctx.stroke(); }
  // laser lines
  const neonColors = ['#ff006e','#00f5d4','#fee440','#8338ec','#3a86ff'];
  for(let i=0;i<3;i++) {
    ctx.strokeStyle = R(neonColors) + '55';
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(0, RI(0,h));
    ctx.lineTo(w, RI(0,h));
    ctx.stroke();
  }
  // chars
  const charW = 28;
  const startX = (w - text.length * charW) / 2 + charW / 2;
  [...text].forEach((ch, i) => {
    ctx.save();
    const x = startX + i * charW;
    const y = h/2 + (Math.random()-0.5)*14;
    ctx.translate(x, y);
    ctx.rotate((Math.random()-0.5)*0.3);
    const color = R(neonColors);
    ctx.shadowColor = color;
    ctx.shadowBlur = 15;
    ctx.fillStyle = '#fff';
    const size = RI(24,34);
    ctx.font = `700 ${size}px "Courier New", monospace`;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(ch, 0, 0);
    // double glow
    ctx.shadowBlur = 30;
    ctx.fillStyle = color;
    ctx.globalAlpha = 0.4;
    ctx.fillText(ch, 0, 0);
    ctx.restore();
  });
  // scan lines
  ctx.globalAlpha = 1;
  for(let y=0;y<h;y+=2) {
    ctx.fillStyle = 'rgba(0,0,0,0.15)';
    ctx.fillRect(0,y,w,1);
  }
}

// Style 3: Watercolor / pastel blocks
function drawStyle3(text) {
  const {ctx,w,h} = setupCanvas(text);
  const baseHue = RI(0,360);
  ctx.fillStyle = '#fafafa';
  ctx.fillRect(0,0,w,h);
  // paint blobs
  for(let i=0;i<12;i++) {
    ctx.fillStyle = hsl((baseHue + RI(0,120)) % 360, RI(40,70), RI(85,95));
    ctx.beginPath();
    ctx.ellipse(RI(0,w), RI(0,h), RI(30,80), RI(20,50), Math.random()*Math.PI, 0, Math.PI*2);
    ctx.fill();
  }
  // chars on colored blocks
  const charW = 34;
  const startX = (w - text.length * charW) / 2 + charW / 2;
  [...text].forEach((ch, i) => {
    ctx.save();
    const x = startX + i * charW;
    const y = h/2 + (Math.random()-0.5)*10;
    const blockHue = (baseHue + i * 30) % 360;
    // block
    ctx.translate(x, y);
    ctx.rotate((Math.random()-0.5)*0.25);
    ctx.fillStyle = hsl(blockHue, 65, 88);
    const bw = RI(26,32), bh = RI(32,40);
    ctx.fillRect(-bw/2, -bh/2, bw, bh);
    // char
    ctx.fillStyle = hsl(blockHue, 70, 30);
    ctx.font = `700 ${RI(22,30)}px "Georgia", serif`;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(ch, 0, 0);
    ctx.restore();
  });
  // splatter dots
  for(let i=0;i<40;i++) {
    ctx.fillStyle = hsl((baseHue+RI(0,180))%360, 50, RI(60,85));
    ctx.beginPath();
    ctx.arc(RI(0,w), RI(0,h), RI(1,4), 0, Math.PI*2);
    ctx.fill();
  }
}

// Style 4: Glitch / digital distortion
function drawStyle4(text) {
  const {ctx,w,h} = setupCanvas(text);
  ctx.fillStyle = '#0f0f0f';
  ctx.fillRect(0,0,w,h);
  const charW = 28;
  const startX = (w - text.length * charW) / 2 + charW / 2;
  // draw text 3 times with RGB offset
  const offsets = [{color:'rgba(255,0,0,0.7)',dx:-3,dy:0},{color:'rgba(0,255,0,0.7)',dx:0,dy:0},{color:'rgba(0,100,255,0.7)',dx:3,dy:0}];
  offsets.forEach(({color,dx,dy}) => {
    ctx.fillStyle = color;
    ctx.globalCompositeOperation = 'screen';
    [...text].forEach((ch, i) => {
      ctx.save();
      const x = startX + i * charW + dx;
      const y = h/2 + dy + (Math.random()-0.5)*6;
      ctx.translate(x, y);
      ctx.rotate((Math.random()-0.5)*0.2);
      ctx.font = `700 ${RI(24,32)}px "Courier New", monospace`;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText(ch, 0, 0);
      ctx.restore();
    });
  });
  ctx.globalCompositeOperation = 'source-over';
  // glitch bars
  for(let i=0;i<6;i++) {
    const gy = RI(0,h);
    const gh = RI(2,8);
    const gx = RI(-10,10);
    ctx.drawImage(ctx.canvas, 0, gy*window.devicePixelRatio, ctx.canvas.width, gh*window.devicePixelRatio, gx, gy, w, gh);
  }
  // noise
  for(let i=0;i<200;i++) {
    ctx.fillStyle = `rgba(255,255,255,${Math.random()*0.1})`;
    ctx.fillRect(RI(0,w), RI(0,h), RI(1,3), 1);
  }
  // horizontal lines
  for(let i=0;i<4;i++) {
    ctx.fillStyle = `rgba(${RI(0,255)},${RI(0,255)},${RI(0,255)},0.08)`;
    const ly = RI(0,h);
    ctx.fillRect(0, ly, w, RI(1,4));
  }
}

// Style 5: Hand-drawn / notebook
function drawStyle5(text) {
  const {ctx,w,h} = setupCanvas(text);
  // paper
  ctx.fillStyle = '#fef9ef';
  ctx.fillRect(0,0,w,h);
  // ruled lines
  for(let y=30;y<h;y+=20) {
    ctx.strokeStyle = 'rgba(180,200,220,0.4)';
    ctx.lineWidth = 0.5;
    ctx.beginPath(); ctx.moveTo(20,y); ctx.lineTo(w-20,y); ctx.stroke();
  }
  // margin line
  ctx.strokeStyle = 'rgba(220,100,100,0.3)';
  ctx.lineWidth = 1;
  ctx.beginPath(); ctx.moveTo(50,0); ctx.lineTo(50,h); ctx.stroke();
  // chars - wobbly hand-drawn style
  const charW = 28;
  const startX = (w - text.length * charW) / 2 + charW / 2;
  const inkColors = ['#1a1a2e','#16213e','#0f3460','#2c3e50','#1b1b2f'];
  [...text].forEach((ch, i) => {
    ctx.save();
    const x = startX + i * charW + (Math.random()-0.5)*4;
    const y = h/2 + (Math.random()-0.5)*8;
    ctx.translate(x, y);
    ctx.rotate((Math.random()-0.5)*0.2);
    const size = RI(24,34);
    ctx.font = `${R(['600','700','800'])} ${size}px "Comic Sans MS", "Georgia", cursive`;
    ctx.fillStyle = R(inkColors);
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(ch, 0, 0);
    // underline wobble
    if(Math.random()>0.6) {
      ctx.strokeStyle = R(inkColors) + '40';
      ctx.lineWidth = 1.5;
      ctx.beginPath();
      ctx.moveTo(-size/3, size/2+2);
      ctx.lineTo(size/3, size/2 + (Math.random()-0.5)*4);
      ctx.stroke();
    }
    ctx.restore();
  });
  // doodles
  for(let i=0;i<5;i++) {
    ctx.strokeStyle = 'rgba(100,100,200,0.08)';
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.arc(RI(0,w), RI(0,h), RI(10,30), 0, Math.PI * Math.random()*2);
    ctx.stroke();
  }
}

// Style 6: Gradient modern
function drawStyle6(text) {
  const {ctx,w,h} = setupCanvas(text);
  const hue1 = RI(0,360), hue2 = (hue1+RI(60,180))%360;
  const grad = ctx.createLinearGradient(0,0,w,h);
  grad.addColorStop(0, hsl(hue1,70,55));
  grad.addColorStop(1, hsl(hue2,70,55));
  ctx.fillStyle = grad;
  ctx.fillRect(0,0,w,h);
  // floating circles
  for(let i=0;i<8;i++) {
    ctx.fillStyle = `rgba(255,255,255,${Math.random()*0.12+0.03})`;
    ctx.beginPath();
    ctx.arc(RI(0,w), RI(0,h), RI(15,50), 0, Math.PI*2);
    ctx.fill();
  }
  // chars
  const charW = 30;
  const startX = (w - text.length * charW) / 2 + charW / 2;
  [...text].forEach((ch, i) => {
    ctx.save();
    const x = startX + i * charW;
    const y = h/2 + Math.sin(i*0.5)*10;
    ctx.translate(x, y);
    ctx.rotate((Math.random()-0.5)*0.3);
    const size = RI(26,36);
    ctx.font = `800 ${size}px -apple-system, "Helvetica Neue", sans-serif`;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    // white text with shadow
    ctx.shadowColor = 'rgba(0,0,0,0.3)';
    ctx.shadowBlur = 6;
    ctx.shadowOffsetY = 2;
    ctx.fillStyle = '#fff';
    ctx.fillText(ch, 0, 0);
    ctx.restore();
  });
  // subtle noise overlay
  for(let i=0;i<60;i++) {
    ctx.fillStyle = `rgba(255,255,255,${Math.random()*0.06})`;
    ctx.beginPath();
    ctx.arc(RI(0,w), RI(0,h), RI(1,3), 0, Math.PI*2);
    ctx.fill();
  }
}

const captchaStyles = [drawStyle1, drawStyle2, drawStyle3, drawStyle4, drawStyle5, drawStyle6];

function drawImage(text) {
  R(captchaStyles)(text);
}

function refreshImage() {
  if(currentWxId) drawImage(currentWxId);
}

function saveImage() {
  if (!isVerified) {
    alert('è¯·å…ˆè¾“å…¥éªŒè¯ç è§£é”ä¸‹è½½åŠŸèƒ½');
    return;
  }
  const c = document.getElementById('imgCanvas');
  const a = document.createElement('a');
  a.download = 'wxcode.png';
  a.href = c.toDataURL('image/png');
  a.click();
}

// ======================== MAIN ========================
function generate() {
  const v = document.getElementById('wxInput').value.trim();
  if(!v) return document.getElementById('wxInput').focus();
  currentWxId = v;

  document.getElementById('out1').textContent = encodeHomoglyph(v);
  document.getElementById('out2').textContent = encodeEmoji(v);
  document.getElementById('out3').textContent = encodePhonetic(v);
  document.getElementById('out4').textContent = encodeZeroWidth(v);
  drawImage(v);
  aiEncode(v);

  const r = document.getElementById('results');
  r.classList.remove('show');
  void r.offsetWidth;
  r.classList.add('show');
  r.scrollIntoView({ behavior:'smooth', block:'start' });
}

// ======================== COPY ========================
function copyText(btn, id) {
  if (!isVerified) {
    alert('è¯·å…ˆè¾“å…¥éªŒè¯ç è§£é”å¤åˆ¶åŠŸèƒ½');
    return;
  }
  const text = document.getElementById(id).textContent;
  if(!text) return;
  navigator.clipboard.writeText(text).then(() => {
    const orig = btn.innerHTML;
    btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><polyline points="20 6 9 17 4 12"/></svg> å·²å¤åˆ¶';
    btn.classList.add('copied');
    setTimeout(() => { btn.innerHTML = orig; btn.classList.remove('copied'); }, 1800);
  }).catch(() => {
    const range = document.createRange();
    range.selectNodeContents(document.getElementById(id));
    const sel = window.getSelection();
    sel.removeAllRanges(); sel.addRange(range);
    document.execCommand('copy');
    const orig = btn.innerHTML;
    btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><polyline points="20 6 9 17 4 12"/></svg> å·²å¤åˆ¶';
    btn.classList.add('copied');
    setTimeout(() => { btn.innerHTML = orig; btn.classList.remove('copied'); }, 1800);
  });
}

document.getElementById('wxInput').addEventListener('keydown', e => { if(e.key==='Enter') generate(); });
</script>

</body>
</html>
